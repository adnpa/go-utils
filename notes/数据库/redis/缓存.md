# 缓存原理

缓存原指CPU和内存间的SRAM，这种存储介质速度介于CPU和内存（DRAM）间，能很好的解决CPU和内存速度差距过大的问题。后来引申为凡是位于速度相差较大的两种硬件之间，用于协调两者数据传输速度差异的结构，均可称之为Cache

缓存能加快存储是因为程序访问内存具有**局部性**

1. 时间局部性(Temporal Locality):
   - 程序在一段时间内会重复访问某些特定的内存区域。
   - 这意味着如果某个数据或指令被访问过,在短时间内它很可能会被再次访问。

2. 空间局部性(Spatial Locality):
   - 程序倾向于访问与刚访问过的内存地址相邻的内存区域。
   - 这意味着如果某个数据或指令被访问过,附近的数据或指令很可能会被接下来访问。

局部性原理是计算机系统设计的基础。它使得缓存技术可以有效地提高系统性能。例如,当CPU访问某个内存地址时,不仅会将该地址的数据加载到缓存中,还会将附近的数据也加载进缓存。这样可以充分利用空间局部性,减少CPU访问主存的次数,提高系统效率。

随着时代发展，除了常见的三级缓存，在分布式等领域也开始使用多级缓存的架构。



## 分布式缓存架构

* 数据丢失问题
  实现Redis数据持久化
* 并发能力问题
  搭建主从集群
* 故障恢复问题
  Redis哨兵，实现健康检测和自动恢复
* 存储能力问题
  主从集群，存储上限仍是单节点上限
  学习elasticsearch，**搭建分片集群**，利用插槽机制实现动态扩容









## 缓存架构

* 哨兵 -> 主从
* 分片 -> 主从



### 分片集群

集群中有多个master，每个master保存不同数据

每个master有多个slave节点，客户端可以访问任意节点，最终都会被转发到正确节点。



因此访问的是分片客户端



## 多级缓存

亿级流量





## 热key问题

